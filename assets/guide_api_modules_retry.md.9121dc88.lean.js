import{E as k,X as J,V as W,N as b,T as X,C as z}from"./chunks/circuit.a6718333.js";import{d as q,o as c,c as E,k as e,t as B,e as H,r as Q,_ as L,h as l,x as m,j as Y,z as G,H as r,w as I,F as N,D as M,b as K,l as Z,p as ee,m as te,C as ae,a as A,Q as se}from"./chunks/framework.2ce6f3f6.js";import{P}from"./chunks/progress-bar.5a5d4239.js";import"./chunks/theme.3af7149e.js";const le="/mollitia/img/retry-linear-mode.png",ne="/mollitia/img/retry-exponential-mode.png",oe="/mollitia/img/retry-jitter-mode-adjust0.1.png",re="/mollitia/img/retry-jitter-mode-adjust0.5.png",pe="/mollitia/img/retry-jitter-mode-adjust1.0.png",ie={class:"number"},ce={key:0,class:"label"},de=["value"],ye=q({__name:"select",props:{modelValue:{default:""},label:{}},emits:["update:modelValue"],setup(d){const o=d;return(n,p)=>(c(),E("div",ie,[e("label",null,[o.label?(c(),E("span",ce,B(o.label),1)):H("",!0),e("select",{value:o.modelValue,onInput:p[0]||(p[0]=y=>n.$emit("update:modelValue",y.target.value))},[Q(n.$slots,"default",{},void 0,!0)],40,de)])]))}});const ue=L(ye,[["__scopeId","data-v-0900e5ef"]]),S=d=>(ee("data-v-0fada32e"),d=d(),te(),d),me={class:"timeout"},Ee={class:"content"},he={class:"form"},fe={class:"row"},ve={class:"row"},ge={class:"row"},xe={class:"row"},be=["value"],_e={class:"row"},we={class:"row"},Ae=S(()=>e("span",null,"Fast First:",-1)),Ce={class:"row"},Fe={class:"visualization"},Ie={class:"row"},De=S(()=>e("span",null,"Progress:",-1)),je={class:"progress"},Te={class:"row"},Ve=q({__name:"retry",setup(d){const o=l(null),n=l(2),p=l(1e3),y=l(2500),f=l(k.CONSTANT),v=l(2),g=l(!1),x=l(.1),h=l(0),i=l(new Array(n.value+1).fill({progress:0,color:"var(--vp-c-brand-3)"})),_=l(0),C=l(0),w=l(0),u=l(0),s=new J({attempts:n.value,interval:p.value,maxInterval:y.value,mode:f.value,factor:v.value,fastFirst:g.value,jitterAdjustment:x.value}),O=new W({options:{modules:[s]}});m([n],()=>{s.attempts=n.value,i.value=new Array(n.value+1).fill({progress:0,color:"var(--vp-c-brand-3)"})}),m([p],()=>{s.interval=p.value}),m([y],()=>{s.maxInterval=y.value}),m([f],()=>{s.mode=f.value}),m([v],()=>{s.factor=v.value}),m([g],()=>{s.fastFirst=g.value}),m([x],()=>{s.jitterAdjustment=x.value});function D(){w.value=Date.now(),u.value=window.setInterval(()=>{i.value[h.value]={progress:Date.now()-w.value,color:"var(--vp-c-brand-3)"},i.value[h.value].progress>=o.value.duration&&clearInterval(u.value)},100)}function j(){h.value=0,i.value=new Array(n.value+1).fill({progress:0,color:"var(--vp-c-brand-3)"}),D()}function T(){clearInterval(u.value),h.value++,D()}function V($,t){o.value.logs.push(`Waiting for ${t}ms before next attempt...`),clearInterval(u.value),i.value[h.value]={progress:o.value.duration,color:"var(--vp-c-red-3)"},C.value=t,w.value=Date.now(),u.value=window.setInterval(()=>{_.value=Date.now()-w.value,_.value>=t&&clearInterval(u.value)},100)}function U(){clearInterval(u.value),i.value[h.value]={progress:o.value.duration,color:"var(--vp-c-red-3)"},_.value=C.value}return Y(()=>{s.on("execute",j),s.on("retry",T),s.on("delay-before-next-retry",V)}),G(()=>{s.off("execute",j),s.off("retry",T),s.off("delay-before-next-retry",V)}),($,t)=>(c(),E("div",me,[r(z,{ref_key:"circuitRef",ref:o,circuit:Z(O),duration:1e3,onFailure:U},{default:I(()=>[e("div",Ee,[e("div",he,[e("div",fe,[r(b,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=a=>n.value=a),label:"Attempts:"},null,8,["modelValue"])]),e("div",ve,[r(b,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=a=>p.value=a),label:"Interval (in ms):"},null,8,["modelValue"])]),e("div",ge,[r(b,{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=a=>y.value=a),label:"Max Interval (in ms):"},null,8,["modelValue"])]),e("div",xe,[r(ue,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=a=>f.value=a),label:"Mode:"},{default:I(()=>[(c(!0),E(N,null,M(Object.values(k),a=>(c(),E("option",{key:a,value:a},B(a.toUpperCase()),9,be))),128))]),_:1},8,["modelValue"])]),e("div",_e,[r(b,{modelValue:v.value,"onUpdate:modelValue":t[4]||(t[4]=a=>v.value=a),label:"Factor:"},null,8,["modelValue"])]),e("div",we,[Ae,r(X,{class:"fast-first",modelValue:g.value,"onUpdate:modelValue":t[5]||(t[5]=a=>g.value=a)},null,8,["modelValue"])]),e("div",Ce,[r(b,{modelValue:x.value,"onUpdate:modelValue":t[6]||(t[6]=a=>x.value=a),step:.1,label:"Jitter Adjustment:"},null,8,["modelValue"])])]),e("div",Fe,[e("div",Ie,[De,e("div",je,[(c(!0),E(N,null,M(n.value+1,(a,F)=>{var R;return c(),K(P,{class:"attempt",key:F,modelValue:i.value[F].progress,color:i.value[F].color,max:(R=o.value)==null?void 0:R.duration},null,8,["modelValue","color","max"])}),128))])]),e("div",Te,[r(P,{class:"internal",modelValue:_.value,max:C.value,label:"Interval:"},null,8,["modelValue","max"])])])])]),_:1},8,["circuit"])]))}});const Re=L(Ve,[["__scopeId","data-v-0fada32e"]]),ke=e("h1",{id:"retry",tabindex:"-1"},[A("Retry "),e("a",{class:"header-anchor",href:"#retry","aria-label":'Permalink to "Retry"'},"â€‹")],-1),Ne=e("p",null,[A("The "),e("code",null,"Retry"),A(" module allows you to "),e("strong",null,"retry"),A(" a function when it fails.")],-1),Me=se("",43),Oe=JSON.parse('{"title":"Retry","description":"","frontmatter":{},"headers":[],"relativePath":"guide/api/modules/retry.md","filePath":"guide/api/modules/retry.md"}'),Pe={name:"guide/api/modules/retry.md"},Ue=Object.assign(Pe,{setup(d){return(o,n)=>{const p=ae("ClientOnly");return c(),E("div",null,[ke,Ne,r(p,null,{default:I(()=>[r(Re)]),_:1}),Me])}}});export{Oe as __pageData,Ue as default};
